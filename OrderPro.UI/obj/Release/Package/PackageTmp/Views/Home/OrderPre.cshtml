
<style>
.button-group {float: none !important;padding:10px 0px 25px 30px !important;width:100% !important;}
.service-title {padding-left:30px !important;}
.pera{margin:0px !important;}
</style>
<div class="row rowContent">

<div class="row button-group" id="addonservice">
 <label class="service-title">
     5. Select if you require any Add-on service</label>
      <div class="button-group">
       <ul>
         @if (ViewBag.AddOnsService != null)
           {
          foreach (var service in ViewBag.AddOnsService)
           {              
             <li>
              <div class="service-1">
               <img src="~/Images/AddOns/@service.ServiceIcon" alt="" class="image-starting">
               <img src="~/Images/AddOns/@service.SelectedIcon" alt="" class="image-invisible">
               <h5>@service.Name</h5>
               <h6>@service.Description</h6>
               <div class="arrow">
               <i class="fa fa-check" aria-hidden="true"></i>
               </div>
               <div class="checkbox-div">
               <input type="checkbox" name="services" id="@service.Reference" onclick="SelectAddOns(this.id)">
              </div>
            </div>
           </li>  
          }
        }                         
        </ul>
    </div>
</div>
 

    <div class="row button-group">
        <label class="service-title">6. Select your preffered delivery option</label>
        <div class="button-group">
            <ul class="select_format">
                @if (ViewBag.OrderDelivery != null)
                {
                    foreach (var delivery in ViewBag.OrderDelivery)
                    {  
                        
                   <li class="delivery">    @*class="text-center"*@
                   <input type="checkbox" class="radio" id="@delivery.Reference" value="JPG" name="format[]" required="required">   
                   <label><span class="send-quote new-one"></span></label>
                   <p class="pera"></p>
                   <label>@delivery.Name (@delivery.Hours Hours)</label>
                   <p class="pera"></p>
                   <label><span class="option-text">@delivery.Description</span></label>
                   </li>                    
                 
                }
            }
            </ul>
        </div>
    </div>


    

 <input type="text" id="AddonsRefCollection" name="AddonsRefCollection" style="display:none"  />
 <input type="text" id="DeliveryRef" name="DeliveryRef" style="display:none"/>
       
 @Html.Hidden("ServiceRef", (string)ViewBag.serviceRef)
 @Html.Hidden("OrderRef", (string)ViewBag.OrderRef)
 @Html.Hidden("UserEmail", (string)ViewBag.UserName)

 
    <div class="row" style="text-align: right; padding-top: 15px; margin-right: 5px">
        <div id="Sendbtn">
            <a id="order" class="btnNext">CONTINUE</a>
        </div>
        <div id="load" style="display: none">
            <img src="~/Images/loading.gif" height="70" />
        </div>
    </div>         

</div>

<script>

        var Addonref="";
        var DeliveryRef = "";     
        var input = 0;    

        function SelectAddOns(e) {            
           
            //alert('select Addon id:' + e + ' input value:' + input);

            //find a string  str.indexOf('word') !== -1
            //str.indexOf('word') !== -1
            var hasValue = Addonref.indexOf(e); //if it does not -1 that 

          //  alert('hasValue:'+hasValue);

            if (hasValue == -1)
            {
                //add
                Addonref += e;
                Addonref += ',';
            }else{
                Addonref = Addonref.replace(e,"");              
            }

                            
            //alert('Addons:'+Addonref);
            document.getElementById("AddonsRefCollection").value = Addonref;

            $('input[name=services]:not(:checked)').parent().removeClass("style_new").parent().removeClass("service-new");
            $('input[name=services]:checked').parent().addClass("style_new").parent().addClass("service-new");
                       
        }

        //function SelectDelivery(e)
        //{
        //    alert(e);
        //    DeliveryRef = e;
        //    document.getElementById("DeliveryRef").value = e;
        //  //  alert(DeliveryRef);

        //}
        $('input.radio').on('change', function () {
            $('input.radio').not(this).prop('checked', false);
            DeliveryRef = this.id;
            document.getElementById("DeliveryRef").value = DeliveryRef;
           // alert(DeliveryRef);
        });


        $('#order').click(function () {

            if (DeliveryRef == "") {
                alert('please select a Delivery.');
            } else {
                
                console.log('before hit');
                DisableButton();
                try{
                    var url = '@Url.Action("Payment", "Home")';                  //"/Home/Instruction";
                    var addons = document.getElementById("AddonsRefCollection").value;// ServiceId;
                    var deliveryref = document.getElementById("DeliveryRef").value;// TotalFile();
                    
                    var orderRef=document.getElementById("OrderRef").value;
                    var serviceRef=document.getElementById("ServiceRef").value;
                    var userEmail=document.getElementById("UserEmail").value;                                    
                    
                    console.log('parameter: url' + url + ' addons' + addons + ' delivery ref' + deliveryref + " User:" + userEmail);

                    $.get(url, {AddonsRefCollection:addons,DeliveryRef:deliveryref,ServiceRef:serviceRef,OrderRef:orderRef,UserName:userEmail }, function (data) {

                        console.log("order pre Response is ok");

                        document.getElementById("load").style.display = "none";
                        document.getElementById("Sendbtn").style.display = "block";
                        // $('#loadingmessage').hide(); // hide the loading message
                        $("#target").html(data);
                        EnableButton();
                    });
                }
                catch (err) {
                    console.log("Exception while calling Instruction.Exp:" + err.message);
                    alert(err.message);
                    EnableButton();
                }
            }
           
            return false;
        })



        function DisableButton() {
            //Disable Next button after uploading image enable this
            document.getElementById("load").style.display = "block";        
            document.getElementById("Sendbtn").style.display = "none";          
          }

        function EnableButton() {
            //Enable Next Button
            document.getElementById("load").style.display = "none";          
            document.getElementById("Sendbtn").style.display = "block";         
         }
     
    </script>

